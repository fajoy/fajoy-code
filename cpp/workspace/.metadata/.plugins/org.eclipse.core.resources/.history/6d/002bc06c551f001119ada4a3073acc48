
#include <iostream>
#include <cstdlib>
#include <stdlib.h>
#include <string>
#include <regex.h>
#include <ctype.h>
using namespace std;

int main() {
int nmatch =1;
int regex_flag = REG_EXTENDED | REG_ICASE ;
regex_t preg;
char * pattern = "[A-Z0-9\\._%+-]+@[A-Z0-9\\.-]+\\.[A-Z]{2,4}"; // 簡單的 Email 格式
regmatch_t pmatch[ nmatch ];
if( regcomp( & preg , pattern  , regex_flag ) != 0 )
{
    printf("regexp comp error.\n");
    exit(0);
}

if( regexec( &preg , str , nmatch , pmatch , 0 ) == 0 )  // 非 0 為 no match
{
    for( i = 0; i < nmatch && pmatch[i].rm_so >= 0 ; ++i )
    {
        * data_length = pmatch[i].rm_eo - pmatch[i].rm_so;  // 透過 *data_length 得知資料該取的長度
        return ( str + pmatch[i].rm_so );
    }
}
regfree(&preg);

exit(EXIT_SUCCESS);
}
